# Compute mixing ratio climatology

import iemdb
from pyIEM import mesonet
import math, numpy
ASOS = iemdb.connect("asos", bypass=True)
acursor = ASOS.cursor()
"""
acursor.execute("SELECT extract(doy from valid) as d, dwpf from alldata where station = 'DSM' and dwpf > -50 and dwpf < 90 and tmpf > -50 and tmpf < 120 and valid > '1950-01-01' ")

dtot = numpy.zeros( (366,), 'f')
dmin = numpy.zeros( (366,), 'f')
dmax = numpy.zeros( (366,), 'f')
dcnt = numpy.zeros( (366,), 'f')
dmin[:] = 100.

for row in acursor:
  dwpc = mesonet.f2c( row[1] )
  e  = 6.112 * math.exp( (17.67 * dwpc) / (dwpc + 243.5));
  mixr =  0.62197 * e / (1000.0 - e)
  if mixr > dmax[row[0] -1]:
    dmax[row[0] -1] = mixr
  if mixr < dmin[row[0] -1]:
    dmin[row[0] -1] = mixr

  dtot[ row[0] -1] += mixr
  dcnt[ row[0] -1] += 1
"""
dmin = [0.0003175872, 0.0003000439, 0.00039010483, 0.00037242699, 0.00023141826, 0.0003000439, 0.00027013454, 0.00025745091, 0.00017552679, 0.00015714132, 0.00024294129, 0.0001845092, 0.00037242699, 0.00023141826, 0.00019583524, 0.0001652707, 0.00021824325, 0.00024294129, 0.00017552679, 0.0001652707, 0.0001652707, 0.0004772075, 0.00041231335, 0.00033604974, 0.0003000439, 0.00037242699, 0.0003521679, 0.00021824325, 0.00027013454, 0.00037242699, 0.00027013454, 0.00019583524, 0.00020778569, 0.00020778569, 0.00020574931, 0.00028609726, 0.00025745091, 0.0003521679, 0.00027013454, 0.00023141826, 0.00025745091, 0.00015714132, 0.0003521679, 0.00053175708, 0.00039010483, 0.00033604974, 0.00021824325, 0.00028609726, 0.00041231335, 0.00041231335, 0.00039010483, 0.0003521679, 0.00055609463, 0.0004772075, 0.00053175708, 0.00050381868, 0.0003521679, 0.0003521679, 0.0003521679, 0.0003175872, 0.00055609463, 0.00053175708, 0.0003521679, 0.00045600487, 0.00033604974, 0.00055609463, 0.00053175708, 0.00050381868, 0.00074274209, 0.00074345799, 0.00053175708, 0.00078304962, 0.00094492559, 0.00078304962, 0.00090570841, 0.00071184797, 0.00090570841, 0.00086057879, 0.00086057879, 0.00074345799, 0.00082452327, 0.00074345799, 0.00064651447, 0.00071184797, 0.00067551224, 0.00078304962, 0.0011940517, 0.00078304962, 0.00086057879, 0.0011940517, 0.0013070161, 0.0014294592, 0.0010366123, 0.00090570841, 0.0011361953, 0.0011361953, 0.0012545338, 0.0011361953, 0.0012545338, 0.0015620729, 0.001372585, 0.0013070161, 0.0011940517, 0.0017887504, 0.0016389557, 0.0017055927, 0.0012545338, 0.00086057879, 0.00086057879, 0.00099399197, 0.0018755168, 0.0020444188, 0.0015620729, 0.0013070161, 0.0014294592, 0.0021255924, 0.0018755168, 0.0022267967, 0.0017055927, 0.0023144018, 0.0016389557, 0.0018755168, 0.0015004872, 0.0022267967, 0.0020444188, 0.0017887504, 0.0019506775, 0.0019506775, 0.0022267967, 0.0018755168, 0.0018755168, 0.0024235866, 0.0024235866, 0.0017055927, 0.0025180669, 0.0022267967, 0.0027583877, 0.0026357803, 0.0024235866, 0.0024235866, 0.0032527617, 0.0027583877, 0.0032527617, 0.0035284618, 0.0028644279, 0.0032527617, 0.0038248582, 0.003660542, 0.003660542, 0.0032527617, 0.003660542, 0.0039957347, 0.0035284618, 0.0039957347, 0.0039957347, 0.0044852463, 0.0044852463, 0.0050634476, 0.0039957347, 0.0043268134, 0.0044852463, 0.0039957347, 0.0046821968, 0.0046821968, 0.0050634476, 0.0038248582, 0.0044852463, 0.0054722154, 0.0057073976, 0.0057073976, 0.0048521888, 0.0043268134, 0.0041433084, 0.0041433084, 0.0052457373, 0.0050634476, 0.0052457373, 0.0054722154, 0.0050634476, 0.0052457373, 0.0061621568, 0.0050634476, 0.0054722154, 0.0057073976, 0.0061621568, 0.0052457373, 0.0057073976, 0.0059102443, 0.0063793752, 0.0063793752, 0.0063793752, 0.0057073976, 0.0054722154, 0.0054722154, 0.0063793752, 0.0071701268, 0.0068815532, 0.0066490653, 0.0074188304, 0.0068815532, 0.0077274558, 0.0074188304, 0.0074188304, 0.0074188304, 0.0063793752, 0.0038248582, 0.0063793752, 0.0066490653, 0.0066490653, 0.0066490653, 0.0057073976, 0.0048521888, 0.0068815532, 0.0068815532, 0.0066490653, 0.0066490653, 0.0063793752, 0.0066490653, 0.0063793752, 0.003660542, 0.0063793752, 0.0061621568, 0.0066490653, 0.0061621568, 0.0057073976, 0.0057073976, 0.0066490653, 0.0071701268, 0.0068815532, 0.0066490653, 0.0050634476, 0.0046821968, 0.0052457373, 0.0063793752, 0.0063793752, 0.0059102443, 0.0063793752, 0.0059102443, 0.0046821968, 0.0038248582, 0.0044852463, 0.0038248582, 0.0026357803, 0.002996475, 0.0050634476, 0.0044852463, 0.0048521888, 0.0043268134, 0.0046821968, 0.0038248582, 0.0043268134, 0.0046821968, 0.0022267967, 0.0017887504, 0.0025180669, 0.0039957347, 0.0038248582, 0.0035284618, 0.0038248582, 0.0038248582, 0.002996475, 0.0028644279, 0.0032527617, 0.0025180669, 0.0027583877, 0.0026357803, 0.002996475, 0.0035284618, 0.0032527617, 0.0031106414, 0.0026357803, 0.0028644279, 0.0017887504, 0.0017887504, 0.0020444188, 0.0022267967, 0.0027583877, 0.0021255924, 0.0017055927, 0.0020444188, 0.0017887504, 0.001372585, 0.0014294592, 0.0021255924, 0.0019506775, 0.0017887504, 0.0015620729, 0.0023144018, 0.0018755168, 0.0018755168, 0.0016389557, 0.0017055927, 0.0017055927, 0.0015004872, 0.0015004872, 0.0014294592, 0.0017887504, 0.0019506775, 0.0017887504, 0.001372585, 0.0019506775, 0.0015004872, 0.0014294592, 0.00086057879, 0.00074345799, 0.00082452327, 0.0010899145, 0.00094492559, 0.0011940517, 0.00086057879, 0.00067551224, 0.00061319623, 0.0010899145, 0.0011361953, 0.00082452327, 0.00082452327, 0.00078304962, 0.00067551224, 0.00074345799, 0.00041231335, 0.00045600487, 0.0010899145, 0.0011361953, 0.00099399197, 0.00094492559, 0.00061319623, 0.00050381868, 0.00058661849, 0.00061319623, 0.00058661849, 0.00078304962, 0.00061319623, 0.0004772075, 0.00043168286, 0.00037242699, 0.00058661849, 0.00061319623, 0.00058661849, 0.00050381868, 0.00041231335, 0.00037242699, 0.00037242699, 0.00039010483, 0.0004772075, 0.0004772075, 0.00039010483, 0.0003000439, 0.0003521679, 0.00019583524, 0.00024294129, 0.00041231335, 0.00027013454, 0.00025745091, 0.00028609726, 0.00023141826, 0.00021824325, 0.00017552679, 0.00020778569, 0.00024294129, 0.00037242699, 0.00043168286, 0.00039010483, 0.00041231335, 0.00043168286, 0.00025745091, 0.00025745091]

dmax = [0.0068815532, 0.0086653503, 0.0083232857, 0.0068815532, 0.0050634476, 0.0057073976, 0.0057073976, 0.0063793752, 0.0059102443, 0.0066490653, 0.0071701268, 0.0052457373, 0.0052457373, 0.0043268134, 0.0061621568, 0.0086653503, 0.0083232857, 0.0077274558, 0.0043268134, 0.0044852463, 0.0077274558, 0.0057073976, 0.0048521888, 0.0048521888, 0.0046821968, 0.0044852463, 0.0050634476, 0.0063793752, 0.0063793752, 0.0071701268, 0.0077274558, 0.0059102443, 0.0050634476, 0.0054722154, 0.0046821968, 0.0059102443, 0.0063793752, 0.0059102443, 0.0086653503, 0.0083232857, 0.010030153, 0.010030153, 0.0068815532, 0.0063793752, 0.0080475332, 0.0083232857, 0.0061621568, 0.0068815532, 0.0063793752, 0.0083232857, 0.0068815532, 0.0071701268, 0.0071701268, 0.0074188304, 0.0068815532, 0.0074188304, 0.0077274558, 0.008959976, 0.010782414, 0.008959976, 0.0086653503, 0.008959976, 0.0096400166, 0.0096400166, 0.008959976, 0.008959976, 0.011213766, 0.010366036, 0.010366036, 0.010782414, 0.010366036, 0.012440976, 0.011213766, 0.0083232857, 0.008959976, 0.0096400166, 0.008959976, 0.0083232857, 0.0083232857, 0.010366036, 0.010030153, 0.010030153, 0.012045086, 0.011213766, 0.012045086, 0.011585014, 0.011213766, 0.011213766, 0.011585014, 0.012440976, 0.011585014, 0.011585014, 0.012440976, 0.011213766, 0.012931491, 0.012440976, 0.012045086, 0.011585014, 0.012045086, 0.015459375, 0.012440976, 0.010030153, 0.013353496, 0.011585014, 0.013353496, 0.012931491, 0.011585014, 0.013876273, 0.017096726, 0.013353496, 0.012440976, 0.013353496, 0.013876273, 0.013353496, 0.013353496, 0.013876273, 0.015459375, 0.013353496, 0.013876273, 0.018311916, 0.012931491, 0.013353496, 0.014325953, 0.01656894, 0.015459375, 0.014325953, 0.015459375, 0.014882916, 0.015955102, 0.015459375, 0.013876273, 0.015955102, 0.014882916, 0.014325953, 0.01656894, 0.01656894, 0.015459375, 0.015955102, 0.017096726, 0.017096726, 0.017750164, 0.01656894, 0.017096726, 0.017750164, 0.019007307, 0.01656894, 0.017750164, 0.018311916, 0.017096726, 0.019007307, 0.019605039, 0.018311916, 0.017750164, 0.017750164, 0.017750164, 0.018311916, 0.018311916, 0.018311916, 0.019007307, 0.018311916, 0.017750164, 0.02034487, 0.019605039, 0.021110045, 0.019605039, 0.02034487, 0.019007307, 0.019605039, 0.019605039, 0.019007307, 0.02034487, 0.019007307, 0.021110045, 0.021767637, 0.019605039, 0.019605039, 0.02034487, 0.021110045, 0.022581402, 0.021110045, 0.021767637, 0.021110045, 0.02034487, 0.021110045, 0.019605039, 0.02034487, 0.02034487, 0.021110045, 0.022581402, 0.021110045, 0.023280671, 0.02034487, 0.022581402, 0.022581402, 0.022581402, 0.021110045, 0.021110045, 0.021767637, 0.022581402, 0.021767637, 0.021110045, 0.023280671, 0.021767637, 0.021767637, 0.021767637, 0.02034487, 0.024292957, 0.02034487, 0.021767637, 0.023280671, 0.021767637, 0.022581402, 0.02034487, 0.021110045, 0.021110045, 0.023280671, 0.02034487, 0.02034487, 0.021110045, 0.022581402, 0.021634642, 0.022581402, 0.021110045, 0.021767637, 0.021110045, 0.021110045, 0.021110045, 0.02034487, 0.02034487, 0.021110045, 0.021767637, 0.021767637, 0.02034487, 0.019605039, 0.022998622, 0.019605039, 0.019605039, 0.019605039, 0.021110045, 0.02034487, 0.021110045, 0.021110045, 0.02034487, 0.019605039, 0.019605039, 0.019605039, 0.019605039, 0.019605039, 0.019809154, 0.019605039, 0.019007307, 0.019605039, 0.019007307, 0.017750164, 0.018311916, 0.017750164, 0.017096726, 0.017750164, 0.021110045, 0.01656894, 0.019605039, 0.019007307, 0.018311916, 0.017096726, 0.015955102, 0.01656894, 0.018311916, 0.017096726, 0.01656894, 0.015955102, 0.017096726, 0.015955102, 0.014325953, 0.014882916, 0.017096726, 0.01656894, 0.01656894, 0.015955102, 0.015459375, 0.017750164, 0.015955102, 0.014882916, 0.015955102, 0.015459375, 0.013876273, 0.015955102, 0.01656894, 0.014882916, 0.014325953, 0.013876273, 0.013876273, 0.013353496, 0.013353496, 0.013353496, 0.012931491, 0.014882916, 0.012440976, 0.012931491, 0.012440976, 0.012045086, 0.012931491, 0.015459375, 0.015459375, 0.011213766, 0.012440976, 0.012440976, 0.011213766, 0.010782414, 0.010782414, 0.011213766, 0.0096400166, 0.010782414, 0.011585014, 0.0093253683, 0.011213766, 0.010366036, 0.010030153, 0.010782414, 0.011213766, 0.012440976, 0.012440976, 0.012440976, 0.011213766, 0.011585014, 0.011585014, 0.011213766, 0.010782414, 0.0093253683, 0.0066490653, 0.011585014, 0.008959976, 0.010782414, 0.011585014, 0.0083232857, 0.010030153, 0.010030153, 0.010030153, 0.010782414, 0.010782414, 0.0096400166, 0.0066490653, 0.0080475332, 0.0061621568, 0.008959976, 0.010782414, 0.0077274558, 0.0093253683, 0.008959976, 0.0063793752, 0.0080475332, 0.008959976, 0.0074188304, 0.0050634476, 0.008959976, 0.0086653503, 0.0059102443, 0.0077274558, 0.008959976, 0.008959976, 0.0083232857, 0.0086653503, 0.0086653503, 0.011213766, 0.008959976, 0.008959976, 0.0054722154]

climate = [0.0021047653, 0.0022791757, 0.0021608891, 0.0020224431, 0.0020753925, 0.0020894245, 0.0018202992, 0.0018351109, 0.0019085925, 0.0019584615, 0.0020059024, 0.0020451888, 0.0019114717, 0.0019563788, 0.0019362126, 0.0021660924, 0.0021729337, 0.0020368879, 0.0020685829, 0.0019538982, 0.0022716089, 0.0022619257, 0.0021600854, 0.0021494471, 0.0019983735, 0.001925792, 0.0019652359, 0.0020602287, 0.0021136687, 0.0020105101, 0.0023170034, 0.0021953655, 0.0021586481, 0.0021116028, 0.0021080289, 0.0022093076, 0.0021766231, 0.0020865235, 0.0021844618, 0.00228346, 0.0023545504, 0.002233777, 0.0022878794, 0.0024631072, 0.0024261149, 0.0023306659, 0.0022412266, 0.0024843095, 0.002747807, 0.0027796386, 0.0027627843, 0.0026544253, 0.002744748, 0.0026695891, 0.0026055805, 0.0026398776, 0.0027205702, 0.0026367449, 0.0029381092, 0.0028323669, 0.0028295685, 0.0029109789, 0.0028298234, 0.0029809875, 0.0028203384, 0.002763205, 0.002861789, 0.0029890053, 0.0032160506, 0.0034458898, 0.0033593397, 0.0034278084, 0.0033869809, 0.0030952187, 0.0032074309, 0.003264491, 0.0034251804, 0.0033507149, 0.0033454681, 0.0032599941, 0.0033625383, 0.0033714822, 0.0035028718, 0.0036355536, 0.0038973356, 0.0041448553, 0.0043288218, 0.0040898561, 0.0041922424, 0.004556519, 0.0042237486, 0.0043024807, 0.0044128317, 0.0040745828, 0.0040749842, 0.0042885584, 0.0043149292, 0.0041402238, 0.0040112925, 0.0041568717, 0.0045704274, 0.0046782102, 0.0047580772, 0.0049719377, 0.0051013161, 0.0052576791, 0.005139966, 0.0057235034, 0.0059361584, 0.0057620304, 0.0057666954, 0.0056575742, 0.005858629, 0.0061159097, 0.0060889046, 0.0062912907, 0.0060661156, 0.0057200845, 0.0060231048, 0.0066156327, 0.0060083959, 0.0061116181, 0.0061674295, 0.0066451137, 0.00675778, 0.0069211666, 0.0070501738, 0.0072555519, 0.0070776045, 0.0071507771, 0.0071621528, 0.0071860482, 0.0072957729, 0.0072459481, 0.007308247, 0.0076226625, 0.0079425219, 0.0080733318, 0.0081335474, 0.0081802364, 0.0082263304, 0.0085703479, 0.0088607538, 0.0086510815, 0.0087876348, 0.0087642604, 0.0088043809, 0.009313426, 0.0094207563, 0.009809942, 0.0097400788, 0.0092161885, 0.0090512875, 0.009087503, 0.0093765389, 0.0098771509, 0.010110113, 0.010796421, 0.010773211, 0.010489706, 0.010684428, 0.011244392, 0.01147259, 0.01128152, 0.011465642, 0.011169328, 0.011091489, 0.011440564, 0.011393471, 0.01151981, 0.011547835, 0.011809827, 0.011684807, 0.011634673, 0.012138463, 0.012223825, 0.012396448, 0.012511358, 0.012308284, 0.012412636, 0.012371312, 0.012235561, 0.012574564, 0.013706033, 0.013132817, 0.012794867, 0.012764692, 0.013509264, 0.013379039, 0.012731388, 0.013021348, 0.013263514, 0.013432424, 0.013301178, 0.013475209, 0.013052105, 0.013568733, 0.013980062, 0.014216392, 0.014485197, 0.014290739, 0.013958165, 0.013641381, 0.01356924, 0.013280923, 0.013321815, 0.013373706, 0.01381843, 0.013591641, 0.013477111, 0.013647054, 0.012988451, 0.012970393, 0.013450072, 0.01376548, 0.013773963, 0.013246619, 0.013047666, 0.013110706, 0.013165927, 0.013345909, 0.012972179, 0.012591915, 0.012620694, 0.012443718, 0.012613257, 0.012743147, 0.012852762, 0.012889445, 0.01311303, 0.01307843, 0.012344305, 0.012650068, 0.012741591, 0.012733875, 0.012377955, 0.012542096, 0.012955499, 0.012866179, 0.012851948, 0.012889518, 0.012319996, 0.011163997, 0.011364507, 0.011717401, 0.011268805, 0.010967637, 0.010911635, 0.011182905, 0.010706338, 0.010781401, 0.010745062, 0.010098685, 0.0098897601, 0.0099066347, 0.0096885208, 0.0092397928, 0.0090490011, 0.0088854441, 0.0092445845, 0.0095941881, 0.009488658, 0.0088564809, 0.0083416998, 0.0079802321, 0.0076002162, 0.0078973351, 0.0078973826, 0.0079120407, 0.0074196239, 0.0072817709, 0.0074326061, 0.0070099304, 0.0070361407, 0.0074667861, 0.0071173087, 0.0067937486, 0.0067523173, 0.0065187584, 0.0065451218, 0.006770866, 0.0061090803, 0.0060746316, 0.0063042403, 0.0061351876, 0.006295756, 0.0063266451, 0.0065732594, 0.0061596646, 0.0060082106, 0.0054904828, 0.0053572082, 0.0054652016, 0.005669158, 0.0057199588, 0.0057990481, 0.0053071557, 0.0049062013, 0.0051124133, 0.0050407131, 0.0050842618, 0.005043936, 0.0053033484, 0.0046430421, 0.0048341663, 0.0048904633, 0.0044037784, 0.0041072471, 0.0041748332, 0.0041370094, 0.0043593147, 0.0040441728, 0.0038759732, 0.0037241415, 0.003841311, 0.0038514535, 0.0040716347, 0.0040353825, 0.004245094, 0.0040789852, 0.0041245893, 0.0041687884, 0.0038600187, 0.0036899061, 0.0033246814, 0.0033482071, 0.0032134717, 0.0030367163, 0.003075548, 0.0033210758, 0.0032224138, 0.0029666258, 0.0028807949, 0.0026317274, 0.0029322896, 0.0031956322, 0.0031016085, 0.0029643537, 0.002954744, 0.0026157026, 0.0025590023, 0.0024957464, 0.002294007, 0.0024499383, 0.0025135966, 0.0025209936, 0.0025676473, 0.0024360865, 0.0024901477, 0.0024181369, 0.0023925246, 0.0023117275, 0.0022686918, 0.0022318419, 0.0022628782, 0.0024418016, 0.0024041764, 0.0023767715, 0.002176875, 0.0022178292, 0.0025220336, 0.0025121092, 0.0024269898, 0.0023920317, 0.0023878331, 0.0022237175]

d2010 = [0.00071134471, 0.00043206755, 0.00064193498, 0.00051696802, 0.00054276118, 0.00098104274, 0.0010049107, 0.00070829812, 0.0006690672, 0.0011694754, 0.0016380847, 0.0015504976, 0.0027530768, 0.003046131, 0.0025845796, 0.0024586306, 0.0034088762, 0.0027899968, 0.0025070414, 0.003144512, 0.0034583986, 0.0035975499, 0.004375929, 0.0028453304, 0.0019504679, 0.0011634488, 0.0015083686, 0.00077563984, 0.00081192143, 0.0010759716, 0.0013331799, 0.0022806651, 0.0016110784, 0.0013792147, 0.0025704091, 0.0030079542, 0.0023389736, 0.0024091841, 0.0016941667, 0.0012754879, 0.0013078606, 0.0015391232, 0.0023013207, 0.002329526, 0.0016149258, 0.0016863042, 0.0016008496, 0.0012321295, 0.0012400758, 0.0020646914, 0.0025381108, 0.0019202068, 0.001520081, 0.0012823439, 0.00074394379, 0.0010021847, 0.0013952743, 0.0013525937, 0.0015908525, 0.0021166541, 0.0019687447, 0.0019167113, 0.0020094828, 0.002264132, 0.0032159504, 0.0039677774, 0.0038941354, 0.0045287623, 0.0049657682, 0.0047012116, 0.0042719301, 0.0043885293, 0.0051135235, 0.0045594629, 0.0042906883, 0.004889559, 0.0045347656, 0.003359227, 0.0026085228, 0.0024609065, 0.0026028834, 0.0040917546, 0.004598707, 0.0030035318, 0.002359736, 0.0040323553, 0.0036981329, 0.0034905847, 0.0045818673, 0.0058951862, 0.0079045827, 0.0069664209, 0.0035642611, 0.0040960293, 0.0056464896, 0.0082759727, 0.0048823482, 0.0030298941, 0.0037693337, 0.0042472063, 0.0047557154, 0.0063730623, 0.0068959184, 0.0072512119, 0.0083562052, 0.0047910777, 0.0026788393, 0.0034561583, 0.0037339872, 0.004112842, 0.0057776924, 0.0064807809, 0.0091339303, 0.0093570929, 0.0070102355, 0.0061303144, 0.0047504534, 0.0053906157, 0.0082109636, 0.0091673657, 0.0060408055, 0.006995474, 0.0049226801, 0.0062347832, 0.004723432, 0.0048261173, 0.0061086165, 0.0036793023, 0.0040566814, 0.0054864543, 0.0062205312, 0.0063828072, 0.0070911623, 0.0054703313, 0.0063556791, 0.0065606898, 0.0069750301, 0.0056433268, 0.0064243008, 0.008294614, 0.0093661305, 0.011459124, 0.014941297, 0.014602851, 0.012498097, 0.011085664, 0.006483864, 0.0071860286, 0.0084292153, 0.011179413, 0.0080603128, 0.011742391, 0.011400931, 0.0097720623, 0.011862312, 0.013173194, 0.0078511657, 0.0096845794, 0.012673679, 0.0094327424, 0.011941878, 0.015880883, 0.015254864, 0.013413298, 0.014466558, 0.012847075, 0.012266867, 0.015251162, 0.013718211, 0.012935679, 0.014459061, 0.014864973, 0.017279839, 0.015626576, 0.011514962, 0.013875835, 0.015162106, 0.014718154, 0.011060975, 0.009386247, 0.01035089, 0.011096366, 0.011435897, 0.014380813, 0.016529894, 0.01696698, 0.0160158, 0.016555129, 0.013056807, 0.011446745, 0.012155429, 0.013943873, 0.014693848, 0.015802687, 0.019407189, 0.013373077, 0.014006912, 0.017771026, 0.015552218, 0.014371295, 0.016092086, 0.017039582, 0.018633174, 0.018975474, 0.015579183, 0.012402311, 0.0150836, 0.018130491, 0.016242191, 0.012116318, 0.015380727, 0.015740626, 0.0155273, 0.017242679, 0.018369304, 0.017120408, 0.012981565, 0.012496158, 0.015246847, 0.018328154, 0.018026087, 0.017380232, 0.017448414, 0.020225916, 0.01773808, 0.01613906, 0.011162486, 0.011926319, 0.013246688, 0.013219618, 0.015387178, 0.01571778, 0.016008994, 0.017097825, 0.015257947, 0.011928471, 0.0086186677, 0.010065482, 0.011182589, 0.010604979, 0.014281505, 0.015590078, 0.017305145, 0.015075834, 0.012399869, 0.0072793872, 0.007159071, 0.009183798, 0.011877172, 0.007286564, 0.0081571536, 0.0091526974, 0.01108562, 0.010160193, 0.009130232, 0.010045144, 0.012097538, 0.012298126, 0.0090258857, 0.010734688, 0.0086112218, 0.0082689403, 0.013287927, 0.013213119, 0.013332852]
d1993 = [0.0010795322, 0.0027431415, 0.0041616284, 0.001587412, 0.0012967911, 0.0016804893, 0.0021461335, 0.0013220251, 0.0019280607, 0.0017201179, 0.0021414068, 0.0030013507, 0.0018139862, 0.0017319216, 0.0016618851, 0.0027488892, 0.0010245518, 0.0010299651, 0.0014124381, 0.0027280457, 0.0033567187, 0.0029163305, 0.0031378579, 0.0015107087, 0.0018474408, 0.0029515254, 0.0028042393, 0.0023598904, 0.00084877346, 0.0015912567, 0.0031025365, 0.0032417381, 0.0029779822, 0.0026933346, 0.0028680286, 0.0033316177, 0.003599616, 0.0034068495, 0.0034200691, 0.0037075402, 0.0039960057, 0.0034221001, 0.0025717968, 0.0021136112, 0.0015014209, 0.0013615022, 0.0010099001, 0.00061180157, 0.00076131523, 0.001807006, 0.0024731911, 0.0025924994, 0.0014156234, 0.0007705391, 0.00090914732, 0.0015478624, 0.0012739527, 0.0014436765, 0.002540984, 0.0038949745, 0.0041325069, 0.0041369977, 0.0035238655, 0.0035388898, 0.0033720715, 0.004203428, 0.0033669525, 0.0032984121, 0.0027266685, 0.0014027205, 0.0015610739, 0.00088300247, 0.0012162778, 0.0028914174, 0.0036147705, 0.00093193835, 0.0015925911, 0.0033547303, 0.0033326524, 0.0033457612, 0.0041735996, 0.0036247047, 0.0038252342, 0.0045848964, 0.0047962698, 0.0052653183, 0.0053066979, 0.0057087266, 0.0068472731, 0.0068168323, 0.0028360756, 0.0023915486, 0.002668418, 0.0021716966, 0.0028756934, 0.00354659, 0.0065372493, 0.0064737159, 0.004712068, 0.0052281185, 0.0048926612, 0.0042078295, 0.0045248116, 0.0050936006, 0.004002206, 0.0033937609, 0.003700583, 0.0066531939, 0.0074378378, 0.0036222024, 0.003102849, 0.0039980593, 0.0062952279, 0.0065707308, 0.0054141041, 0.005391458, 0.0076334476, 0.0069027171, 0.0058097602, 0.0052913786, 0.0092683695, 0.0082940226, 0.0080846129, 0.0095065068, 0.0096934848, 0.011436775, 0.012408664, 0.011565411, 0.0098163476, 0.011289177, 0.012133754, 0.0089895912, 0.005628407, 0.0082828347, 0.0068710712, 0.0058876718, 0.0064283796, 0.0059446003, 0.0041961675, 0.0042260825, 0.004897513, 0.0090943305, 0.011487485, 0.007296985, 0.006151034, 0.0074967672, 0.010907299, 0.0088154776, 0.0085274568, 0.01031235, 0.0077917282, 0.0069565848, 0.0085937167, 0.0083098616, 0.0076544383, 0.007430302, 0.01057779, 0.015015704, 0.013065898, 0.0077720401, 0.0096877953, 0.010681159, 0.013289715, 0.013406553, 0.0097232424, 0.0081294989, 0.011857796, 0.015891606, 0.015074085, 0.013200249, 0.01169598, 0.010994098, 0.013728727, 0.015294152, 0.013001111, 0.0087076994, 0.011018445, 0.012857956, 0.013624883, 0.015143231, 0.01401119, 0.014727983, 0.016739346, 0.017574998, 0.015320719, 0.013441271, 0.012571636, 0.01374758, 0.01602103, 0.014114202, 0.014605821, 0.013839257, 0.010130229, 0.013636461, 0.01570656, 0.013777644, 0.015610188, 0.018069079, 0.016815476, 0.015110027, 0.011948847, 0.012457685, 0.013484801, 0.014726411, 0.016041784, 0.013952051, 0.014420926, 0.016777186, 0.012286787, 0.012003374, 0.014548275, 0.015305079, 0.012737921, 0.010252987, 0.0098500596, 0.0080822436, 0.01074924, 0.0091574136, 0.00961057, 0.011523834, 0.016272942, 0.01647334, 0.017026355, 0.016130915, 0.016320167, 0.016079361, 0.016789466, 0.01697571, 0.018101545, 0.017617157, 0.015688324, 0.012633068, 0.012491823, 0.016319564, 0.015243296, 0.015708923, 0.01662728, 0.016856849, 0.014327412, 0.013357218, 0.015028528, 0.014181734, 0.0088310959, 0.0095672663, 0.013000471, 0.0094326446, 0.0095593398, 0.0082483161, 0.0078477524, 0.0084681259, 0.0088656079, 0.0084402608, 0.0067891385, 0.0083267717, 0.013178852, 0.012986849, 0.0059517366, 0.0055150357, 0.0064770095, 0.0075438092, 0.0088189337, 0.0094146682, 0.0094874203, 0.0093839522, 0.010990269, 0.0057603228, 0.0068549928, 0.0080496687, 0.0061973021, 0.004856918, 0.0049179187, 0.0044859196, 0.0052332156, 0.0057079126, 0.0037200795, 0.0060281516, 0.005858379, 0.005300771, 0.010817281, 0.011454395, 0.010282187, 0.0036777903, 0.0035866431, 0.0049724146, 0.004529635, 0.004269632, 0.0068596345, 0.0092291757, 0.0087783905, 0.006667953, 0.0067873248, 0.0076314844, 0.0067556738, 0.0032869044, 0.0044168974, 0.0050430605, 0.0055185524, 0.0056805634, 0.0043721939, 0.0029681346, 0.0031733336, 0.0020743732, 0.002319718, 0.0022839182, 0.0023765708, 0.0030875222, 0.0032748759, 0.0044170739, 0.0026000827, 0.0015790354, 0.0022319772, 0.0031625621, 0.0031901533, 0.0033838155, 0.0036561133, 0.0054243729, 0.0054119811, 0.0042150188, 0.0034693435, 0.0039915196, 0.0039501605, 0.0043769148, 0.0031683336, 0.0026237813, 0.0034536177, 0.0038290333, 0.0040471801, 0.0045270603, 0.0023111757, 0.0013789184, 0.0019847371, 0.0022997914, 0.0025692398, 0.002814661, 0.0035068588, 0.0037032375, 0.0039069601, 0.0036386421, 0.0038777597, 0.0024962777, 0.0027698588, 0.0025941601, 0.0049113627, 0.0029087912, 0.0017149597, 0.0024559612, 0.0041340343, 0.004311942, 0.0038478056, 0.004114606, 0.0044709942, 0.0036313392, 0.00339403, 0.0022844612, 0.0021616346, 0.0013958621, 0.0012481731, 0.001793589, 0.0011969253, 0.001312769, 0.00097803678, 0.00081867882, 0.0013701143, 0.0018223269, 0.0022140816]
import matplotlib.pyplot as plt

climate = numpy.array(climate)
d1993 = numpy.array(d1993)
d2010 = numpy.array(d2010)
dmax = numpy.array(dmax)
dmin = numpy.array(dmin)

fig = plt.figure()
ax = fig.add_subplot(211)

ax.fill_between(numpy.arange(0,366), dmin * 1000., dmax * 1000., color='gray')

ax.plot(numpy.arange(0,366), climate * 1000., label="Climatology")
ax.plot(numpy.arange(0,len(d2010)), d2010 * 1000., color='r', label="2010")

ax.set_title("Des Moines [KDSM] Daily Mean Surface Water Vapor Mixing Ratio")
ax.set_ylabel("Mixing Ratio ($g/kg$)")
ax.set_xlim(0,366)
ax.set_ylim(0, 26.)
ax.set_xticks( (1,32,60,91,121,152,182,213,244,274,305,335,365) )
ax.set_xticklabels( ('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec') )
ax.grid(True)
ax.legend(loc=2)

ax = fig.add_subplot(212)

rects = ax.bar(numpy.arange(0,len(d2010)), (d2010  - climate[:len(d2010)]) * 1000.0, edgecolor='r')
for rect in rects:
  if rect.get_y() < 0.:
    rect.set_facecolor('b')
    rect.set_edgecolor('b')
  else:
    rect.set_facecolor('r')

ax.set_ylabel("2010 Departure ($g/kg$)")
ax.set_xlim(0,366)
ax.set_xticks( (1,32,60,91,121,152,182,213,244,274,305,335,365) )
ax.set_xticklabels( ('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec') )
ax.grid(True)

import iemplot
fig.savefig('test.ps')
iemplot.makefeature('test')
