<?php
include("../../config/settings.inc.php");
include("../../include/myview.php");
include("../../include/database.inc.php");

$t = new MyView();
define("IEM_APPID", 145);

$t->title = "RWIS Archived Webcam Imagery";
$t->headextra = <<<EOF
 <link rel="stylesheet" href="/vendor/jquery-ui/1.11.4/jquery-ui.css" />
EOF;
$t->jsextra = <<<EOF
 <script src="/vendor/jquery-ui/1.11.4/jquery-ui.js"></script>
 <script src="camera.js"></script>
EOF;
$t->thispage = "networks-rwis";

$conn = iemdb("mesosite");
$rs = pg_query($conn, "SELECT id, name, date(sts) as s from webcams WHERE network = 'IDOT'
		ORDER by name ASC");
$sform = "<select name='cid'>";
for ($i=0;$row=@pg_fetch_assoc($rs,$i);$i++){
	$sform .= sprintf("<option value='%s'>%s -- (%s)</option>\n", $row["id"], $row["name"],
			$row["s"]);
}
$sform .= "</select>";


$t->content = <<<EOF
<h3>Archived Iowa RWIS Webcam Imagery</h3>

<p>The IEM archives imagery provided by the Iowa DOT RWIS network.  Each site
with a webcam has a number of preset views that are each queried about once
per 10 minutes.  Please select the webcam view you wish to see and then 
select a date of interest.  The left hand menu will automatically populate with
a listing of images available for that date. <strong>Hint:</strong> Once you
select a time, use the up/down keyboard arrow to create a quasi-timelapse.</p>

<p>Archiving started back on 19 Dec 2009.  The start date of invidual webcams
is shown in the select menu.

<div style="border: 3px solid #EEE; width: 900px;">
<div style="background: #eee; border-bottom: 4px solid #ccc;">
 <span style="font-weight: bold;">1. Select Webcam View:</span>{$sform}
 <span style="font-weight: bold;">2. Date:</span> <input type="text" id="datepicker" />
 <input type="hidden" id="realdate" />
</div>
<div style="float: left; min-width: 100px; border-right: 4px solid #ccc; padding: 3px; background: #eee;">
 <span style="font-weight: bold;">3. Select Time:</span><br />
 <select size="30" name="times">
 </select>
</div>
<img id="theimage" src="camera_instructions.png" style="float: left; margin: 5px;"/>

<br clear="all" />
</div>
EOF;
$t->render("single.phtml");
?>
